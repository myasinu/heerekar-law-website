(function(c){typeof define=="function"&&define.amd?define(c):c()})(function(){"use strict";var Pt=Object.defineProperty;var St=(c,a,l)=>a in c?Pt(c,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):c[a]=l;var U=(c,a,l)=>(St(c,typeof a!="symbol"?a+"":a,l),l),W=(c,a,l)=>{if(!a.has(c))throw TypeError("Cannot "+l)};var p=(c,a,l)=>(W(c,a,"read from private field"),l?l.call(c):a.get(c)),f=(c,a,l)=>{if(a.has(c))throw TypeError("Cannot add the same private member more than once");a instanceof WeakSet?a.add(c):a.set(c,l)},y=(c,a,l,k)=>(W(c,a,"write to private field"),k?k.call(c,l):a.set(c,l),l);var g=(c,a,l)=>(W(c,a,"access private method"),l);var m,E,_,b,C,j,x,et,N,nt,P,T,$,st;const c=document.body.getAttribute("data-api")||"api";let a;if(c==="local"){const n=/analytics-(\w+)\.scorpion\.co/.exec(window.location.hostname);n!=null&&n[1]?a=`https://${n[1]}.scorpion.co/platform/analytics`:a="https://sa.scorpion.co"}else c==="api"?a="https://sa.scorpion.co":c.endsWith("-csx")?a=`https://${c.replace("-csx","")}.scorpion.co/platform/analytics`:a=`https://${c}.scorpion.co/platform/analytics`;function l(n){return n.width!==void 0}function k(n){return n.video!==void 0}function it(n){return n.to!==void 0}async function ot(n){const t=await w("/event/visit",n);return t==null?void 0:t.result}async function Y(n){const t=await w("/event/click",n);return t==null?void 0:t.result}async function ct(n){const t=await w("/event/restart",n);return t==null?void 0:t.result}async function at(n){const t=await w("/event/update-phone",n);return t==null?void 0:t.result}async function M(n){const t=await w("/event/play",n),e=t==null?void 0:t.result;return rt(n,e),e}function rt(n,t){if(t!=null&&t.videoPlayId&&n.videoId){const e=document.getElementById(n.videoId);if(e instanceof HTMLVideoElement){const s=e.sa;s&&(s.vvid=t.videoPlayId,s.vpid=t.videoPlayingId)}}}async function V(n){const t=await w("/event/playing",n);return t==null?void 0:t.result}async function dt(n){const t=await w("/event/init",n);return t==null?void 0:t.result}async function w(n,t){const e=`${a}${n}`;return await(await fetch(e,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t),keepalive:!0})).json()}function lt(n){return n?encodeURIComponent(String(n)).replace(/['"()]/g,function(t){switch(t){case"'":return"%27";case'"':return"%22";case"(":return"%28";case")":return"%29";default:return t}}):""}function ut(n){return n?decodeURIComponent(String(n).replace(/\+/g,"%20")):""}function ht(n){const t=n.target,e=t==null?void 0:t.closest("a"),s=(e==null?void 0:e.getAttribute("href"))||void 0,i=t==null?void 0:t.closest("button"),o=i==null?void 0:i.closest("form"),r=o==null?void 0:o.getAttribute("action"),u=(o==null?void 0:o.getAttribute("method"))==="post"||!1,h=e||i||t,S=r&&(o==null?void 0:o.getAttribute("data-search"))&&ft(o);return{selector:mt(h).join(" "),href:s,post:u,search:S||void 0}}function ft(n){const t=n==null?void 0:n.getElementsByTagName("input");if(t){for(const e of t)if((e==null?void 0:e.getAttribute("type"))==="text"&&gt(e))return e.value}}function gt(n){return!!(n&&(n.offsetWidth||n.offsetHeight||n.getClientRects().length))}function mt(n){const t=pt(n),e=[];for(const s of t){let i;if(s.id)return e.unshift(`#${s.id}`),e;if(s.cls)i=`${s.name}.${s.cls}`;else if(s.name)i=s.name;else continue;const o=s.el.querySelectorAll(i);if(o.length>1){const r=Array.prototype.indexOf.call(o,s.el);r!==-1&&(i+=`:nth-child(${r+1})`)}e.unshift(i)}return e}function pt(n){const t=[];let e=n;for(;e&&e.parentNode&&e!==document.body&&e!==document.documentElement;){const s=e.getAttribute("id");if(s)return t.push({el:e,id:s}),t;const i=wt(e),o=(e.nodeName||"").toLowerCase();(i||o==="li"||!t.length)&&t.push({el:e,name:o,cls:i}),e=e.parentNode}return t}function wt(n){const t=(n.getAttribute("class")||"").trim();return t?t.replace(/(\s+)|([^\w-])/g,function(e,s,i){return s?".":i?`\\${i}`:""}):""}function It(){const n=new Date,t=new Date(n.getFullYear(),0,1),e=new Date(n.getFullYear(),6,1);return Math.max(t.getTimezoneOffset(),e.getTimezoneOffset())/60}function q(){const n=document.getElementsByTagName("a");for(const t of n){const e=t.getAttribute("href"),s=e&&/^tel:(.+)$/.exec(e);if(s){const i=s[1].replace(/\D+/g,"");if(i&&i.length>=10)return i}}}function yt(){const n=document.getElementsByClassName("ui-track-version"),t=new Set;for(let e=0;e<n.length;e++){const s=n[e].getAttribute("id");s&&t.add(s)}return t.size?[...t]:void 0}function z(){var t,e;let n;try{n=(e=(t=window.Process)==null?void 0:t.Phones)==null?void 0:e.call(t)}catch{}return n==null?void 0:n.split("|")}const vt=new Set(["_cldee","_gl","_hsenc","adct","adid","adposition","adsubid","bidmatchtype","cam","campaignid","cmp","creative","date_created","device","devicemodel","dicbo","dynamic_proxy","epik","esid","external_browser_redirect","fbclid","fccdbefkve","fccdbeve","furl","g","gad","gclid","hsa_acc","hsa_ad","hsa_cam","hsa_grp","hsa_kw","hsa_mt","hsa_net","hsa_src","hsa_tgt","hsa_ver","interestloc","keyword","keywordid","kw","li_fat_id","loc_interest_ms","loc_physical_ms","matchtype","mc_cid","mc_eid","ms","msclkid","nb","network","networktype","nx","oborigurl","physicalloc","pp","primary_serv","psafe_param","pub_cr_id","querystr","random","refpageviewid","rl_key","rl_site","rl_siteid","rl_sitelink","se_action","sppc","sppcadexid","sppcadid","sppccampaignid","sppckeywordid","ssp_iabi","targetid","tblci","tc","testmode","twclid","useyb","usps_mid","usps_sn","utm_brand","utm_campaign","utm_content","utm_medium","utm_scrub","utm_source","utm_term","vs_key","wbraid"]);function O(n){let t;if(window.location.search){const e=new URL(window.location.href),s=new URLSearchParams,i=[...e.searchParams];for(const[r,u]of i){const h=r==null?void 0:r.toLowerCase();(!h||!vt.has(h))&&s.set(r,u)}const o=s.toString();o?t=`${window.location.pathname}?${o}#~${n}`:t=`${window.location.pathname}#~${n}`}else t=`#~${n}`;window.history.replaceState(void 0,"",t)}function H(){const n=window.location.hash;if((n==null?void 0:n.length)===38&&n[1]==="~")return n.substring(2)}const d={get:n=>{const t=document.cookie.match(`(^|;)\\s*${n}\\s*=\\s*([^;]+)`),e=t==null?void 0:t.pop();if(!e)return null;switch(e[0]){case"#":return+e.substring(1);case"!":return e==="!!";case":":return new Date(+e.substring(1));default:return ut(e)}},set:(n,t,e=!1)=>{if(t===null||typeof t>"u"){d.delete(n);return}let s;typeof t=="number"?s=`#${t}`:typeof t=="boolean"?s=t?"!!":"!":t?t instanceof Date?s=`:${t.getTime()}`:typeof t=="string"?s=lt(t):s=String(t):s="";let i;e?e instanceof Date||(i=new Date,typeof e=="number"?i.setDate(i.getDate()+e):i.setDate(i.getDate()+30)):i=null;const o=i?`; expires = ${i.toUTCString()}`:"";document.cookie=`${n}=${s}; path=/${o}`},delete:n=>{const t=new Date(0).toUTCString();document.cookie=`${n}=; path=/; expires=${t}`}},X=document.documentElement.getAttribute("data-sa"),v=X?decodeURIComponent(X):"",R=!document.documentElement.getAttribute("data-sd")&&!window.location.hostname.endsWith("scorpion.co"),B="_sa",F="sa_",K="vid_",G="sa_info",_t=24*60*60*1e3,A=class A{constructor(){f(this,C);f(this,x);f(this,N);f(this,P);f(this,$);f(this,m,void 0);U(this,"ready");f(this,E,void 0);f(this,_,!1);f(this,b,[]);this.ready=new Promise(e=>y(this,m,e)),g(this,x,et).call(this)||g(this,P,T).call(this,!0),this._click=this._click.bind(this),this._play=this._play.bind(this),this._playing=this._playing.bind(this),window._sa_videoStart=this._play,window._sa_videoPlay=this._playing,window._sa_getHitId=()=>this.hidId,document.addEventListener("click",this._click,!0)}get visitorId(){return localStorage.getItem(K)||void 0}set visitorId(t){localStorage.setItem(K,t)}get sessionId(){const t=Number(localStorage.getItem(G));if(!t)return;const e=new Date().getTime()-_t;if(t<e)return;const s=d.get(F);return s?String(s):void 0}set sessionId(t){d.set(F,t),localStorage.setItem(G,String(new Date().getTime()))}get legacyId(){return+(d.get(B)||0)}set legacyId(t){d.set(B,t);try{const e=new CustomEvent("analytics.sessionId",{bubbles:!0,cancelable:!0,detail:{sessionId:t}});document.documentElement.dispatchEvent(e)}catch{}}get hidId(){return p(this,E)}set hitId(t){y(this,E,t)}_click(t){const e=ht(t),s=window.innerWidth||document.documentElement.offsetWidth||document.body.offsetWidth||0,i=window.innerHeight||document.documentElement.offsetHeight||document.body.offsetHeight||0,o=Math.max(document.documentElement.scrollTop,document.body.scrollTop),r={sessionId:this.sessionId||"",hitId:this.hidId||"",sa:v,page:window.location.href,selector:e.selector,width:s,height:i,scrollTop:o,x:t.pageX||t.clientX||0,y:t.pageY||t.clientY||0,href:e.href,post:e.post,search:e.search,location:Number(d.get("L"))||0};if(r.sessionId){Y(r);return}else g(this,C,j).call(this,r)}_play(t,e,s,i,o,r){const u={videoPlayId:e||void 0,sessionId:this.sessionId||"",hitId:this.hidId||"",sa:v,page:window.location.href,videoId:t,video:s,from:i,duration:o,autoStart:!!r,location:Number(d.get("L"))||0};u.sessionId?M(u):g(this,C,j).call(this,u)}_playing(t,e,s,i){const o={videoPlayId:t,videoPlayingId:e,sa:v,page:window.location.href,to:s,duration:i,location:Number(d.get("L"))||0};V(o)}};m=new WeakMap,E=new WeakMap,_=new WeakMap,b=new WeakMap,C=new WeakSet,j=function(t){p(this,b).push(t),p(this,_)||g(this,P,T).call(this)},x=new WeakSet,et=function(){if(!R||d.get("SPPC"))return!1;const t=this.sessionId,e=H();return e&&e!==t?(g(this,N,nt).call(this,e),!0):!1},N=new WeakSet,nt=async function(t){var o,r;const e={...J(this.visitorId,this.sessionId),restartId:t},s=await ct(e);if(!(s!=null&&s.sessionId)){await g(this,P,T).call(this);return}if(this.visitorId=s.visitorId,this.sessionId=s.sessionId,this.hitId=s.hitId,s.paid){d.set("SPPC",s.paid,30),d.set("PPCAD",s.adId||null,30),d.set("PPCEX",s.adExtension||null,30),d.set("PPCCMP",s.campaignId||null,30);try{await fetch(window.location.href)}catch{}try{(r=(o=window.Process)==null?void 0:o.Delayed)==null||r.call(o)}catch{}const u=q();if(u&&u!==e.phoneNumber){const h={sessionId:s.sessionId,hitId:s.hitId,sa:v,page:window.location.href,phoneNumber:u,pooling:z()};await at(h)}}d.get("SPPC")&&s.sessionId&&s.sessionId!==H()&&O(s.sessionId)},P=new WeakSet,T=async function(t=!1){var r,u,h,S;const e=this.visitorId,s=this.sessionId,i=J(e,s);t&&R&&i.paid&&s&&O(s),y(this,_,!0);const o=await ot(i);if(y(this,_,!1),!(o!=null&&o.sessionId)){(r=p(this,m))==null||r.call(this),y(this,m,void 0);return}if(o.sessionId!==s&&(this.legacyId=0),this.visitorId=o.visitorId,this.sessionId=o.sessionId,this.hitId=o.hitId,t&&R&&i.paid&&o.sessionId&&o.sessionId!==H()&&O(o.sessionId),t)try{(h=(u=window.Process)==null?void 0:u.Delayed)==null||h.call(u)}catch{}if(!this.legacyId){const D={id:this.sessionId,sa:v,page:window.location.href},I=await dt(D);if(!(I!=null&&I.legacyId)||I.sessionId!==o.sessionId)return;this.legacyId=I.legacyId}await g(this,$,st).call(this),(S=p(this,m))==null||S.call(this),y(this,m,void 0)},$=new WeakSet,st=async function(){const t=this.sessionId,e=this.hidId;if(!t||!e)return;const s=[...p(this,b)];if(s.length){p(this,b).length=0;for(const i of s)l(i)?(i.sessionId=t,i.hitId=e,await Y(i)):k(i)?(i.sessionId=t,i.hitId=e,await M(i)):it(i)&&await V(i)}},U(A,"current",new A);let Z=A;function J(n,t){const e=new URL(window.location.href),s=new Map,i=[...e.searchParams];for(const[L,Q]of i){const tt=L==null?void 0:L.toUpperCase();tt&&Q&&s.set(tt,Q)}const o=d.get("SPPC")||s.get("SPPC")||void 0,r=d.get("SEOR")||document.referrer,u=d.get("SEOK")||s.get("KEYWORD")||s.get("KEYWORDS")||void 0,h=window.innerWidth||document.documentElement.offsetWidth||document.body.offsetWidth||0,S=window.innerHeight||document.documentElement.offsetHeight||document.body.offsetHeight||0,D=Number(d.get("PPCAD"))||Number(s.get("SPPCADID"))||void 0,I=Number(d.get("PPCEX"))||Number(s.get("SPPCADEXID"))||void 0,bt=Number(d.get("PPCCMP"))||Number(s.get("SPPCCAMPAIGNID"))||void 0;return{visitorId:n,sessionId:t,sa:v,page:window.location.href,paid:o,referrer:r,keywords:u,width:h,height:S,timeZone:It(),phoneNumber:q(),adId:D,adExtension:I,campaignId:bt,location:Number(d.get("L"))||void 0,engagement:yt(),pooling:z()}}});
//# sourceMappingURL=sa.js.map
